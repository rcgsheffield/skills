<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accessible Modal Dialog Template - University of Sheffield</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      line-height: 1.6;
    }

    /* Modal backdrop */
    .modal-backdrop {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
    }

    .modal-backdrop.active {
      display: block;
    }

    /* Modal dialog */
    .modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 24px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      z-index: 1000;
    }

    .modal.active {
      display: block;
    }

    .modal-header {
      margin-bottom: 16px;
    }

    .modal-title {
      margin: 0;
      font-size: 24px;
    }

    .modal-body {
      margin-bottom: 24px;
    }

    .modal-footer {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
    }

    .btn-primary {
      background-color: #005eb8;
      color: white;
    }

    .btn-primary:hover {
      background-color: #004a94;
    }

    .btn-secondary {
      background-color: #e0e0e0;
      color: #333;
    }

    .btn-secondary:hover {
      background-color: #d0d0d0;
    }

    button:focus {
      outline: 2px solid #005eb8;
      outline-offset: 2px;
    }

    .close-button {
      position: absolute;
      top: 16px;
      right: 16px;
      background: transparent;
      border: none;
      font-size: 24px;
      cursor: pointer;
      padding: 4px 8px;
      line-height: 1;
    }

    .close-button:hover {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>

<main>
  <h1>Modal Dialog Example</h1>

  <p>Click the button below to open an accessible modal dialog.</p>

  <button id="open-modal-btn" class="btn-primary">
    Open Modal
  </button>

  <p>This template demonstrates an accessible modal dialog that follows WCAG 2.1 AA requirements:</p>
  <ul>
    <li>Focus is trapped within the modal</li>
    <li>Escape key closes the modal</li>
    <li>Focus returns to trigger button when closed</li>
    <li>Background is inert when modal is open</li>
    <li>Proper ARIA attributes for screen readers</li>
  </ul>
</main>

<!-- Modal Backdrop -->
<div id="modal-backdrop" class="modal-backdrop" aria-hidden="true"></div>

<!-- Modal Dialog -->
<div
  id="modal"
  class="modal"
  role="dialog"
  aria-modal="true"
  aria-labelledby="modal-title"
  aria-describedby="modal-description"
>
  <!-- Close button -->
  <button
    type="button"
    class="close-button"
    aria-label="Close dialog"
    onclick="closeModal()"
  >
    &times;
  </button>

  <!-- Modal Header -->
  <div class="modal-header">
    <h2 id="modal-title" class="modal-title">Confirm Action</h2>
  </div>

  <!-- Modal Body -->
  <div id="modal-description" class="modal-body">
    <p>Are you sure you want to proceed with this action? This cannot be undone.</p>
    <p>Additional information about the action can be placed here.</p>
  </div>

  <!-- Modal Footer -->
  <div class="modal-footer">
    <button type="button" class="btn-secondary" onclick="closeModal()">
      Cancel
    </button>
    <button type="button" class="btn-primary" onclick="confirmAction()">
      Confirm
    </button>
  </div>
</div>

<script>
  // Store reference to element that opened modal
  let triggerElement = null;

  // Get elements
  const modal = document.getElementById('modal');
  const modalBackdrop = document.getElementById('modal-backdrop');
  const openModalBtn = document.getElementById('open-modal-btn');

  // Get all focusable elements in modal
  function getFocusableElements() {
    return modal.querySelectorAll(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
    );
  }

  // Open modal
  function openModal() {
    // Store element that triggered modal
    triggerElement = document.activeElement;

    // Show modal and backdrop
    modal.classList.add('active');
    modalBackdrop.classList.add('active');

    // Prevent body scroll
    document.body.style.overflow = 'hidden';

    // Move focus to first focusable element in modal
    const focusableElements = getFocusableElements();
    if (focusableElements.length > 0) {
      focusableElements[0].focus();
    }

    // Set up focus trap
    setupFocusTrap();
  }

  // Close modal
  function closeModal() {
    // Hide modal and backdrop
    modal.classList.remove('active');
    modalBackdrop.classList.remove('active');

    // Restore body scroll
    document.body.style.overflow = '';

    // Return focus to trigger element
    if (triggerElement) {
      triggerElement.focus();
    }

    // Remove event listeners
    document.removeEventListener('keydown', handleKeyDown);
  }

  // Confirm action
  function confirmAction() {
    console.log('Action confirmed');
    // Perform your action here

    // Show success message (example)
    alert('Action completed successfully!');

    // Close modal
    closeModal();
  }

  // Focus trap
  function setupFocusTrap() {
    document.addEventListener('keydown', handleKeyDown);
  }

  function handleKeyDown(e) {
    // Close on Escape
    if (e.key === 'Escape') {
      closeModal();
      return;
    }

    // Trap focus on Tab
    if (e.key === 'Tab') {
      const focusableElements = getFocusableElements();
      const firstElement = focusableElements[0];
      const lastElement = focusableElements[focusableElements.length - 1];

      // Shift + Tab on first element -> focus last element
      if (e.shiftKey && document.activeElement === firstElement) {
        e.preventDefault();
        lastElement.focus();
      }
      // Tab on last element -> focus first element
      else if (!e.shiftKey && document.activeElement === lastElement) {
        e.preventDefault();
        firstElement.focus();
      }
    }
  }

  // Open modal on button click
  openModalBtn.addEventListener('click', openModal);

  // Close modal when clicking backdrop
  modalBackdrop.addEventListener('click', closeModal);

  // Prevent clicks inside modal from closing it
  modal.addEventListener('click', (e) => {
    e.stopPropagation();
  });
</script>

</body>
</html>
